/*
 * Copyright (c) 2025 Linumiz GmbH
 * SPDX-License-Identifier: Apache-2.0
 */

/dts-v1/;
#include <arm/infineon/cat1c/cyt4dn/cyt4dn_m7.dtsi>
#include "kit_t2g_c2d6m_lite_common.dtsi"
#include <zephyr/dt-bindings/pwm/pwm.h>
#include <dt-bindings/adc/adc.h>

/ {

	model = "Infineon Evaluation board for CYT4DNJBZS M7 Core 0";
	compatible = "infineon,kit_t2g_c2d6m_lite", "infineon,cyt4dn";

	chosen {
		zephyr,sram = &sram_m7_0;
		zephyr,flash = &code_flash0;
		zephyr,dtcm = &dtcm;
		zephyr,itcm = &itcm;
		zephyr,code-partition = &m7_0_partition;
		zephyr,console = &uart7;
		zephyr,shell-uart = &uart7;
		zephyr,canbus = &can0;
		zephyr,flash-controller = &flash_controller;
	};
};

&m7_0 {
	status = "okay";
};

&uart7 {
	status = "okay";
};

i2c11: &scb11 {
       compatible = "infineon,cat1-i2c-pdl";
       status = "okay";

       #address-cells = <1>;
       #size-cells = <0>;

       pinctrl-0 = <&p0_4_scb11_i2c_scl &p0_5_scb11_i2c_sda>;
       pinctrl-names = "default";

       clocks = <&clk_hf2>;
       ifx,peri-group = <IFX_PERI_GRP_INST_SEL(1, 0)>;
       ifx,peri-clk = <0x0113>;
       ifx,peri-div = <0>; /* 8-bit divider */
       ifx,peri-div-inst = <1>;

       accel@53 {
               compatible = "adi,adxl345";
               reg = <0x53>;
       };
};

&can0_1 {
	compatible = "infineon,cat1-can";
	clocks = <&clk_hf2>;
	clock-frequency = <40000000>;
	ifx,peri-group = <IFX_PERI_GRP_INST_SEL(1, 0)>;
	ifx,peri-clk = <0x0101>;
	ifx,peri-div = <3>; /* 24-bit divider */
	ifx,peri-div-inst = <0>;

	pinctrl-0 = <&p5_2_can0_1_tx &p5_3_can0_1_rx>;
	pinctrl-names = "default";
};

can0: &can0_0 {
	compatible = "infineon,cat1-can";
	status = "okay";
	clocks = <&clk_hf2>;
	clock-frequency = <40000000>;
	ifx,peri-group = <IFX_PERI_GRP_INST_SEL(1, 0)>;
	ifx,peri-clk = <0x0100>;
	ifx,peri-div = <3>; /* 24-bit divider */
	ifx,peri-div-inst = <0>;

	pinctrl-0 = <&p5_1_can0_0_rx &p5_0_can0_0_tx>;
	pinctrl-names = "default";
};

spi0: &scb0 {
	#address-cells = <1>;
	#size-cells = <0>;
	compatible = "infineon,cat1-spi-pdl";
	status = "okay";

	pinctrl-0 = <&p11_3_scb0_spi_mosi &p11_0_scb0_spi_miso &p11_2_scb0_spi_clk>;
	pinctrl-names = "default";
	cs-gpios = <&gpio_prt11 1 GPIO_ACTIVE_LOW>;

	ifx,peri-group = <IFX_PERI_GRP_INST_SEL(1, 0)>;
	ifx,peri-clk = <0x0108>;
	ifx,peri-div = <1>; /* 16-bit divider */
	ifx,peri-div-inst = <3>;

	slow@0 {
		compatible = "test-spi-loopback-slow";
		reg = <0>;
		spi-max-frequency = <3000000>;
	};

	fast@0 {
		compatible = "test-spi-loopback-fast";
		reg = <0>;
		spi-max-frequency = <3000000>;
	};
};

&adc0 {
       status = "okay";
       clock-frequency = <26670000>;
       ifx,peri-group = <IFX_PERI_GRP_INST_SEL(1, 0)>;
       ifx,peri-clk = <0x0114>;
       ifx,peri-div = <0>; /* 8-bit divider */
       ifx,peri-div-inst = <2>;
};

&eth0_mac {
       status = "okay";
	pinctrl-0 = <&p13_2_eth_txd_0 &p13_3_eth_txd_1 &p13_6_eth_txd_2 &p13_7_eth_txd_3
		     &p13_4_eth_txd_clk &p14_0_eth_tx_ctl &p14_2_eth_rxd_clk
		     &p14_3_eth_rxd_0 &p14_4_eth_rxd_1 &p14_5_eth_rxd_2
		     &p14_6_eth_rxd_3 &p14_7_eth_rx_ctl &p13_5_eth_ref_clk>;
	pinctrl-names = "default";
	phy-connection-type = "rgmii";

	phy-handle = <&eth0_phy>;
	clock-frequency = <125000000>;
	local-mac-address = [b0 19 21 67 36 00];
};

&eth0_mdio {
	pinctrl-0 = <&p13_0_eth_mdc &p13_1_eth_mdio>;
	pinctrl-names = "default";
	status = "okay";

	eth0_phy: phy@1 {
		compatible = "realtek,rtl8211f";
		reg = <0x1>;
		status = "okay";
		reset-gpios = <&gpio_prt12 4 (GPIO_PULL_UP | GPIO_ACTIVE_LOW)>;
	};
};

&i2s0 {
	status = "okay";
	pinctrl-0 = <&p15_6_tdm_i2s0_tx_mck &p15_7_tdm_i2s0_tx_sck &p16_0_tdm_i2s0_tx_fsync &p16_1_tdm_i2s0_tx_sd>;
	pinctrl-names = "default";
	clksel = <0>;
};

&gpio_prt12 {
       status = "okay";
};

&gpio_prt13 {
       status = "okay";
};

&gpio_prt14 {
       status = "okay";
};

&clk_hf7 {
        status = "okay";
};

&clk_hf6 {
        status = "okay";
};

&clk_hf5 {
        status = "okay";
};
