# Copyright (c) 2025 Infineon Technologies AG,
# or an affiliate of Infineon Technologies AG.
#
# SPDX-License-Identifier: Apache-2.0

description: |
  Infineon CAT1 PDL-based I2C driver

  This driver configures the SCB as an I2C device.

  Example devicetree configuration with vl53l0x Time-of-Flight (ToF)
  ranging sensor connected on the bus:

  i2c3: &scb3 {
      compatible = "infineon,cat1-i2c-pdl";
      status = "okay";

      #address-cells = <1>;
      #size-cells = <0>;

      pinctrl-0 = <&p6_0_scb3_i2c_scl &p6_1_scb3_i2c_sda>;
      pinctrl-names = "default";

      vl53l0x@29 {
        compatible = "st,vl53l0x";
        reg = <0x29>;
      };
  };

  The pinctrl nodes need to be configured as open-drain and
  input-enable:

  &p6_0_scb3_i2c_scl {
    drive-open-drain;
    input-enable;
  };

  &p6_1_scb3_i2c_sda {
    drive-open-drain;
    input-enable;
  };

compatible: "infineon,cat1-i2c-pdl"

include: [i2c-controller.yaml, pinctrl-device.yaml, "infineon,cat1-scb.yaml"]

properties:
  reg:
    type: array
    required: true

  system-interrupts:
    type: array
    required: true

  pinctrl-0:
    description: |
      PORT pin configuration for SCL, SDA signals.
      We expect that the phandles will reference pinctrl nodes. These
      nodes will have a nodelabel that matches the Infineon SoC Pinctrl
      defines and have following
      format: p<port>_<pin>_<peripheral inst>_<signal>.

      Examples:
        pinctrl-0 = <&p6_0_scb3_i2c_scl &p6_1_scb3_i2c_sda>;
    required: true

  pinctrl-names:
    required: true

  clock-frequency:
    type: int
    description: |
      Frequency that the I2C bus runs

  ifx,peri-clk:
    type: int
    description:
      Clock selection for peripheral

  ifx,peri-group:
    type: int
    description:
      Peripheral clock divider group and inst for scb i2c

  ifx,peri-div:
    type: int
    required: true
    enum:
      - 0 # 8-bit divider
      - 1 # 16-bit divider
      - 2 # 16_5-bit divider
      - 3 # 24_5-bit divider
    description:
      Peripheral clock divider type.

  ifx,peri-div-inst:
    type: int
    required: true
    description:
      Peripheral clock divider type instance. peripheral clock divider has
      multiple instnace of same type divider, so this property is used to specifi
      which instance to be used. please refer device specific datasheet for
      number of instance present for every divider type.
